# TODO 04: å·¥ä½œç›®å½•è®¾ç½®ä¸é›†æˆæµ‹è¯•

> å¯¹åº” spec: `specs/04-workspace-settings-and-integration.md`

## Agent é…ç½®ç®¡ç†

- [ ] åˆ›å»º `lib/agentConfig.ts`
- [ ] å®ç° `loadAgentConfig()`: ä» localStorage è¯»å–é…ç½®
- [ ] å®ç° `saveAgentWorkDir(path)`: ä¿å­˜å·¥ä½œç›®å½• + æ›´æ–°æœ€è¿‘ä½¿ç”¨åˆ—è¡¨
- [ ] å®ç° `loadRecentDirs()`: åŠ è½½æœ€è¿‘ä½¿ç”¨ç›®å½•åˆ—è¡¨
- [ ] å®ç° `removeRecentDir(path)`: ç§»é™¤å•ä¸ªå†å²ç›®å½•
- [ ] å®ç° `clearRecentDirs()`: æ¸…ç©ºæ‰€æœ‰å†å²ç›®å½•
- [ ] å®šä¹‰é…ç½®æ›´æ–°äº‹ä»¶ `AGENT_CONFIG_UPDATED_EVENT`
- [ ] æœ€è¿‘ç›®å½•åˆ—è¡¨ä¸Šé™ 10 ä¸ªï¼Œè‡ªåŠ¨å»é‡

## Agent è®¾ç½®é¢æ¿

- [ ] åˆ›å»º `components/AgentSettingsPanel.tsx`
- [ ] é»˜è®¤å·¥ä½œç›®å½•è¾“å…¥æ¡† + ğŸ“ æ–‡ä»¶å¤¹é€‰æ‹©æŒ‰é’®
- [ ] æœ€è¿‘ä½¿ç”¨ç›®å½•åˆ—è¡¨ + åˆ é™¤æŒ‰é’®
- [ ] "æ¸…é™¤æ‰€æœ‰å†å²" æŒ‰é’®
- [ ] ä¿å­˜æŒ‰é’® + ä¿å­˜æˆåŠŸæç¤º
- [ ] ä½¿ç”¨ agentConfig.ts ä¸­çš„å‡½æ•°è¿›è¡Œè¯»å†™

## SettingsContainer é›†æˆ

- [ ] åœ¨ SettingsContainer ä¾§è¾¹æ æ·»åŠ  "Agent è®¾ç½®" å¯¼èˆªé¡¹
- [ ] æ·»åŠ å¯¹åº”å›¾æ ‡ï¼ˆå¦‚ Bot æˆ– Terminal å›¾æ ‡ï¼‰
- [ ] æ¡ä»¶æ¸²æŸ“ AgentSettingsPanel
- [ ] i18n: æ·»åŠ  "Agent Settings" / "Agent è®¾ç½®" ç¿»è¯‘

## Electron IPC æ‰©å±•

- [ ] ä¿®æ”¹ `electron/preload.js`: æ·»åŠ  `selectDirectory` æ–¹æ³•åˆ° electronAPI
- [ ] ä¿®æ”¹ `electron/main.js`: æ·»åŠ  `select-directory` IPC handler
- [ ] ä¿®æ”¹ `types/electron.d.ts`: æ·»åŠ  `selectDirectory` ç±»å‹å£°æ˜
- [ ] æµ‹è¯• Electron ç¯å¢ƒä¸‹æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†æ­£å¸¸å¼¹å‡º

## å•å…ƒæµ‹è¯•

- [ ] åˆ›å»º `lib/__tests__/agentLlmAdapter.test.ts`
  - [ ] æµ‹è¯• OpenAI åè®®è½¬æ¢
  - [ ] æµ‹è¯• Anthropic åè®®è½¬æ¢
  - [ ] æµ‹è¯• custom æ¨¡å‹è½¬æ¢
  - [ ] æµ‹è¯•ç¼ºå¤±å­—æ®µé»˜è®¤å€¼
- [ ] åˆ›å»º `lib/__tests__/agentConfig.test.ts`
  - [ ] æµ‹è¯•é…ç½®åŠ è½½/ä¿å­˜
  - [ ] æµ‹è¯•æœ€è¿‘ç›®å½•åˆ—è¡¨ç®¡ç†
  - [ ] æµ‹è¯•ä¸Šé™å’Œå»é‡é€»è¾‘
- [ ] åˆ›å»º `lib/__tests__/agentStreamParser.test.ts`
  - [ ] æµ‹è¯•æ­£å¸¸ SSE è§£æ
  - [ ] æµ‹è¯•åˆ†åŒ…åœºæ™¯
  - [ ] æµ‹è¯•å„ç±»äº‹ä»¶ç±»å‹
- [ ] åˆ›å»º `components/__tests__/AgentToggle.test.tsx`
  - [ ] æµ‹è¯•å¼€å…³åˆ‡æ¢
  - [ ] æµ‹è¯• disabled çŠ¶æ€
- [ ] åˆ›å»º `components/__tests__/AgentToolCallDisplay.test.tsx`
  - [ ] æµ‹è¯•å„çŠ¶æ€æ¸²æŸ“ï¼ˆrunning, complete, errorï¼‰
  - [ ] æµ‹è¯•å±•å¼€/æŠ˜å 

## é›†æˆæµ‹è¯•

- [ ] æµ‹è¯•åœºæ™¯ 1: åŸºæœ¬ Agent å¯¹è¯ â€” å‘é€æ¶ˆæ¯ â†’ å·¥å…·è°ƒç”¨ â†’ ç»“æœå±•ç¤º
- [ ] æµ‹è¯•åœºæ™¯ 2: æ–‡ä»¶ç¼–è¾‘ â€” read_file â†’ edit_file â†’ éªŒè¯ä¿®æ”¹
- [ ] æµ‹è¯•åœºæ™¯ 3: Shell å‘½ä»¤ â€” execute_command â†’ è¾“å‡ºå±•ç¤º
- [ ] æµ‹è¯•åœºæ™¯ 4: æ¨¡å¼åˆ‡æ¢ â€” æ™®é€š â†” Agent æ¨¡å¼ä¸ä¸¢å¤±æ¶ˆæ¯å†å²
- [ ] æµ‹è¯•åœºæ™¯ 5: é”™è¯¯å¤„ç† â€” æ— æ•ˆç›®å½• / æ— æ•ˆ API Key / å·¥å…·æ‰§è¡Œå¤±è´¥

## æ‰‹åŠ¨éªŒè¯

- [ ] Electron ç¯å¢ƒï¼šæ–‡ä»¶å¤¹é€‰æ‹©å™¨æ­£å¸¸å·¥ä½œ
- [ ] Web ç¯å¢ƒï¼šè·¯å¾„è¾“å…¥æ­£å¸¸å·¥ä½œ
- [ ] è¯»å†™ç”¨æˆ·æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶
- [ ] é•¿æ—¶é—´å‘½ä»¤ä¸è¶…æ—¶
- [ ] åœæ­¢æŒ‰é’®ä¸­æ–­ Agent
- [ ] åˆ‡æ¢å¯¹è¯æ—¶ Agent çŠ¶æ€é‡ç½®
- [ ] Settings ä¿å­˜çš„ç›®å½•é‡å¯åæ­£ç¡®åŠ è½½
- [ ] å¹¶å‘ Agent ä¼šè¯ä¸äº’ç›¸å¹²æ‰°

## éƒ¨ç½²æ£€æŸ¥

- [ ] ç¡®è®¤ `electron-builder.json` åŒ…å« pi-mono ä¾èµ–
- [ ] ç¡®è®¤ Electron æ‰“åŒ…å Agent åŠŸèƒ½æ­£å¸¸
- [ ] ç¡®è®¤ Web ç”Ÿäº§æ„å»ºï¼ˆnpm run buildï¼‰æ— æŠ¥é”™
